{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/AI_Projects/bp-cleaning-app/src/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr'\n\nexport function createClient() {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n  if (!supabaseUrl || !supabaseKey) {\n    // Return a mock client for build time\n    return {\n      auth: {\n        getUser: async () => ({ data: { user: null }, error: null }),\n        signInWithPassword: async () => ({ error: { message: 'Not configured' } }),\n        signUp: async () => ({ error: { message: 'Not configured' } }),\n        signOut: async () => {},\n        onAuthStateChange: () => ({ data: { subscription: { unsubscribe: () => {} } } })\n      },\n      from: () => ({\n        select: () => ({ \n          eq: () => ({ \n            order: () => ({ data: [], error: null }),\n            single: () => ({ data: null, error: null }),\n            lte: () => ({ data: [], error: null }),\n            gte: () => ({ data: [], error: null }),\n            limit: () => ({ data: [], error: null })\n          }),\n          order: () => ({ data: [], error: null }),\n          lte: () => ({ data: [], error: null }),\n          gte: () => ({ data: [], error: null })\n        }),\n        insert: () => ({ error: null }),\n        update: () => ({ error: null })\n      })\n    } as any\n  }\n\n  return createBrowserClient(supabaseUrl, supabaseKey)\n}\n"],"names":[],"mappings":";;;;AAGsB;AAHtB;AAAA;;AAEO,SAAS;IACd,MAAM;IACN,MAAM;IAEN;;IA6BA,OAAO,IAAA,oMAAmB,EAAC,aAAa;AAC1C"}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///C:/AI_Projects/bp-cleaning-app/src/components/providers/auth-provider.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useEffect, useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport type { User } from '@supabase/supabase-js'\nimport type { Profile } from '@/lib/types'\n\ninterface AuthContextType {\n  user: User | null\n  profile: Profile | null\n  loading: boolean\n  isSuperuser: boolean\n  signOut: () => Promise<void>\n  refreshProfile: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  profile: null,\n  loading: true,\n  isSuperuser: false,\n  signOut: async () => {},\n  refreshProfile: async () => {}\n})\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [profile, setProfile] = useState<Profile | null>(null)\n  const [loading, setLoading] = useState(true)\n  const supabase = createClient()\n\n  const fetchProfile = async (userId: string) => {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', userId)\n      .single()\n    \n    if (error) {\n      console.error('Error fetching profile:', error)\n      return null\n    }\n    return data as Profile\n  }\n\n  const refreshProfile = async () => {\n    if (user) {\n      const profile = await fetchProfile(user.id)\n      setProfile(profile)\n    }\n  }\n\n  useEffect(() => {\n    const getUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser()\n      setUser(user)\n      \n      if (user) {\n        const profile = await fetchProfile(user.id)\n        setProfile(profile)\n      }\n      \n      setLoading(false)\n    }\n\n    getUser()\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event: any, session: any) => {\n        setUser(session?.user ?? null)\n        \n        if (session?.user) {\n          const profile = await fetchProfile(session.user.id)\n          setProfile(profile)\n        } else {\n          setProfile(null)\n        }\n        \n        setLoading(false)\n      }\n    )\n\n    return () => subscription.unsubscribe()\n  }, [])\n\n  const signOut = async () => {\n    await supabase.auth.signOut()\n    setUser(null)\n    setProfile(null)\n    // Force redirect to avoid state issues\n    window.location.href = '/login'\n  }\n\n  return (\n    <AuthContext.Provider value={{\n      user,\n      profile,\n      loading,\n      isSuperuser: profile?.role === 'superuser',\n      signOut,\n      refreshProfile\n    }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport const useAuth = () => useContext(AuthContext)\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;AAHA;;;AAgBA,MAAM,4BAAc,IAAA,8KAAa,EAAkB;IACjD,MAAM;IACN,SAAS;IACT,SAAS;IACT,aAAa;IACb,SAAS,WAAa;IACtB,gBAAgB,WAAa;AAC/B;AAEO,SAAS,aAAa,EAAE,QAAQ,EAAiC;;IACtE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAiB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,mJAAY;IAE7B,MAAM,eAAe,OAAO;QAC1B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QACT,MAAM;QAET,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO;QACT;QACA,OAAO;IACT;IAEA,MAAM,iBAAiB;QACrB,IAAI,MAAM;YACR,MAAM,UAAU,MAAM,aAAa,KAAK,EAAE;YAC1C,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;kCAAC;YACR,MAAM;kDAAU;oBACd,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;oBACtD,QAAQ;oBAER,IAAI,MAAM;wBACR,MAAM,UAAU,MAAM,aAAa,KAAK,EAAE;wBAC1C,WAAW;oBACb;oBAEA,WAAW;gBACb;;YAEA;YAEA,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB;0CAChE,OAAO,OAAY;oBACjB,QAAQ,SAAS,QAAQ;oBAEzB,IAAI,SAAS,MAAM;wBACjB,MAAM,UAAU,MAAM,aAAa,QAAQ,IAAI,CAAC,EAAE;wBAClD,WAAW;oBACb,OAAO;wBACL,WAAW;oBACb;oBAEA,WAAW;gBACb;;YAGF;0CAAO,IAAM,aAAa,WAAW;;QACvC;iCAAG,EAAE;IAEL,MAAM,UAAU;QACd,MAAM,SAAS,IAAI,CAAC,OAAO;QAC3B,QAAQ;QACR,WAAW;QACX,uCAAuC;QACvC,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAC3B;YACA;YACA;YACA,aAAa,SAAS,SAAS;YAC/B;YACA;QACF;kBACG;;;;;;AAGP;GAhFgB;KAAA;AAkFT,MAAM,UAAU;;IAAM,OAAA,IAAA,2KAAU,EAAC;AAAW;IAAtC"}}]
}