module.exports=[210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},14548,a=>{"use strict";let b=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],14548)},66384,a=>{"use strict";let b=(0,a.i(70106).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);a.s(["ShieldAlert",()=>b],66384)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},39726,a=>{"use strict";let b={detergente:"consumabile",sgrassatore:"consumabile",disinfettante:"consumabile",lucidante:"consumabile",deodorante:"consumabile",accessorio:"attrezzatura",attrezzatura:"attrezzatura",altro:"attrezzatura"};a.s(["CATEGORIES_BY_TYPE",0,{all:["detergente","sgrassatore","disinfettante","lucidante","deodorante","accessorio","attrezzatura","altro"],consumabile:["detergente","sgrassatore","disinfettante","lucidante","deodorante"],attrezzatura:["accessorio","attrezzatura","altro"]},"CATEGORY_ICONS",0,{detergente:"ðŸ§´",sgrassatore:"ðŸ’ª",disinfettante:"ðŸ§¹",lucidante:"âœ¨",deodorante:"ðŸŒ¸",accessorio:"ðŸ§¤",attrezzatura:"ðŸ› ï¸",altro:"ðŸ“¦"},"CATEGORY_LABELS",0,{detergente:"Detergente",sgrassatore:"Sgrassatore",disinfettante:"Disinfettante",lucidante:"Lucidante",deodorante:"Deodorante",accessorio:"Accessorio",attrezzatura:"Attrezzatura",altro:"Altro"},"STATUS_LABELS",0,{active:"Attivo",paused:"In pausa",completed:"Completato"},"UNIT_LABELS",0,{litri:"Litri",pezzi:"Pezzi",kg:"Kg",ml:"ml",rotoli:"Rotoli",confezioni:"Confezioni"},"filterProductsByType",0,(a,c)=>"all"===c?a:a.filter(a=>b[a.category]===c)])},81560,a=>{"use strict";let b=(0,a.i(70106).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],81560)},26117,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95445),f=a.i(64696),g=a.i(39726),h=a.i(210),i=a.i(83497),j=a.i(14548),k=a.i(96221),l=a.i(66384),m=a.i(81560);function n(){let a=(0,d.useParams)(),n=(0,d.useRouter)(),{isSuperuser:o,loading:p}=(0,f.useAuth)(),q=(0,e.createClient)(),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)("detergente"),[J,K]=(0,c.useState)("pezzi"),[L,M]=(0,c.useState)(1),[N,O]=(0,c.useState)(0),[P,Q]=(0,c.useState)(0),[R,S]=(0,c.useState)(5),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)("");(0,c.useEffect)(()=>{a.id&&!p&&o&&X()},[a.id,p,o]);let X=async()=>{let{data:b,error:c}=await q.from("products").select("*").eq("id",a.id).single();if(c||!b)return void n.push("/prodotti");y(b),C(b.sku||""),E(b.barcode||""),G(b.name||""),I(b.category||"detergente"),K(b.unit||"pezzi"),M(b.quantity_per_package||1),O(b.unit_cost||0),Q(b.current_stock||0),S(b.min_stock||5),U(b.supplier_id||""),W(b.notes||"");let{data:d}=await q.from("suppliers").select("*").eq("is_active",!0).order("name");d&&A(d),s(!1)},Y=async b=>{if(b.preventDefault(),!F.trim())return void alert("Inserisci il nome del prodotto");u(!0);try{let{error:b}=await q.from("products").update({name:F.trim(),category:H,unit:J,quantity_per_package:L,unit_cost:N,current_stock:P,min_stock:R,supplier_id:T||null,notes:V.trim()||null}).eq("id",a.id);b?(console.error("Error updating product:",b),alert("Errore durante il salvataggio: "+b.message)):n.push(`/prodotti/${a.id}`)}catch(a){console.error("Error:",a),alert("Errore durante il salvataggio")}finally{u(!1)}},Z=async()=>{if(!x)return;let{count:b}=await q.from("movements").select("*",{count:"exact",head:!0}).eq("product_id",a.id);if(b&&b>0){if(!confirm(`Questo prodotto ha ${b} movimenti associati. Vuoi disattivarlo? Il prodotto non sar\xe0 pi\xf9 visibile ma i dati storici saranno mantenuti.`))return}else if(!confirm(`Sei sicuro di voler eliminare "${x.name}"? Questa azione non pu\xf2 essere annullata.`))return;w(!0);try{let{error:b}=await q.from("products").update({is_active:!1}).eq("id",a.id);b?(console.error("Error deleting product:",b),alert("Errore durante l'eliminazione: "+b.message)):n.push("/prodotti")}catch(a){console.error("Error:",a),alert("Errore durante l'eliminazione")}finally{w(!1)}};return p||r?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)(k.Loader2,{className:"w-8 h-8 text-blue-600 animate-spin"})}):o?x?(0,b.jsxs)("div",{className:"min-h-screen pb-24",children:[(0,b.jsx)("header",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("button",{onClick:()=>n.back(),className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,b.jsx)(h.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"text-blue-100",children:"Modifica Prodotto"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center",children:(0,b.jsx)(i.Package,{className:"w-7 h-7"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-blue-200 text-xs font-mono",children:B}),(0,b.jsx)("h1",{className:"text-xl font-bold",children:x.name})]})]})]})}),(0,b.jsxs)("form",{onSubmit:Y,className:"max-w-4xl mx-auto px-4 -mt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"bg-gray-50 rounded-2xl border border-gray-200 p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"SKU (non modificabile)"}),(0,b.jsx)("input",{type:"text",value:B,disabled:!0,className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-500 bg-gray-100 cursor-not-allowed font-mono text-sm"})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-2xl border border-gray-200 p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Barcode (non modificabile)"}),(0,b.jsx)("input",{type:"text",value:D,disabled:!0,className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-500 bg-gray-100 cursor-not-allowed font-mono text-sm"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Prodotto *"}),(0,b.jsx)("input",{type:"text",value:F,onChange:a=>G(a.target.value),placeholder:"Es. Detergente Multiuso 5L",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),(0,b.jsx)("select",{value:H,onChange:a=>I(a.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(g.CATEGORY_LABELS).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c},a))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unita"}),(0,b.jsx)("select",{value:J,onChange:a=>K(a.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(g.UNIT_LABELS).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c},a))})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"QtÃ  per Conf."}),(0,b.jsx)("input",{type:"number",value:L,onChange:a=>M(Number(a.target.value)),min:"1",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario â‚¬"}),(0,b.jsx)("input",{type:"number",value:N,onChange:a=>O(Number(a.target.value)),min:"0",step:"0.01",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Giacenza Attuale"}),(0,b.jsx)("input",{type:"number",value:P,onChange:a=>Q(Number(a.target.value)),min:"0",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,b.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Usa i movimenti per aggiornare la giacenza"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scorta Minima"}),(0,b.jsx)("input",{type:"number",value:R,onChange:a=>S(Number(a.target.value)),min:"0",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fornitore"}),(0,b.jsxs)("select",{value:T,onChange:a=>U(a.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,b.jsx)("option",{value:"",children:"-- Nessun fornitore --"}),z.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (opzionale)"}),(0,b.jsx)("textarea",{value:V,onChange:a=>W(a.target.value),placeholder:"Note aggiuntive...",rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("button",{type:"submit",disabled:t||!F.trim(),className:"w-full flex items-center justify-center gap-2 p-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-2xl font-semibold hover:from-blue-700 hover:to-blue-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"w-5 h-5 animate-spin"}),"Salvataggio..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Save,{className:"w-5 h-5"}),"Salva Modifiche"]})}),(0,b.jsx)("button",{type:"button",onClick:Z,disabled:v,className:"w-full flex items-center justify-center gap-2 p-4 bg-white border-2 border-red-200 text-red-600 rounded-2xl font-semibold hover:bg-red-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:v?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"w-5 h-5 animate-spin"}),"Disattivazione..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Trash2,{className:"w-5 h-5"}),"Disattiva Prodotto"]})})]})]})]}):null:(0,b.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,b.jsx)(l.ShieldAlert,{className:"w-8 h-8 text-red-600"})}),(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Accesso Negato"}),(0,b.jsx)("p",{className:"text-gray-500 mb-4",children:"Solo i superuser possono modificare i prodotti."}),(0,b.jsx)("button",{onClick:()=>n.push("/prodotti"),className:"px-4 py-2 bg-blue-600 text-white rounded-xl font-medium",children:"Torna ai Prodotti"})]})}a.s(["default",()=>n])}];

//# sourceMappingURL=_237a3f7a._.js.map