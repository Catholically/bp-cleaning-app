module.exports=[13749,a=>{"use strict";let b=(0,a.i(70106).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["ChevronLeft",()=>b],13749)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},66384,a=>{"use strict";let b=(0,a.i(70106).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);a.s(["ShieldAlert",()=>b],66384)},55488,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-up-from-line",[["path",{d:"m18 9-6-6-6 6",key:"kcunyi"}],["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 21h14",key:"11awu3"}]]);a.s(["ArrowUpFromLine",()=>b],55488)},7484,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-down-to-line",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);a.s(["ArrowDownToLine",()=>b],7484)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],60246)},21886,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95445),f=a.i(68114),g=a.i(64696),h=a.i(11300),i=a.i(7484),j=a.i(55488),k=a.i(13749),l=a.i(60246),m=a.i(66384),n=a.i(96221),o=a.i(38246);function p(){let[a,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)("all"),{user:u,isSuperuser:v,isManager:w,loading:x}=(0,g.useAuth)(),y=(0,e.createClient)(),z=(0,d.useRouter)();(0,c.useEffect)(()=>{!x&&w&&z.replace("/")},[w,x,z]),(0,c.useEffect)(()=>{u&&!w&&A()},[u,v,w]);let A=async()=>{let a=y.from("movements").select(`
        *,
        product:products(name, unit),
        worksite:worksites(code, name),
        operator:profiles(full_name)
      `).order("movement_date",{ascending:!1}).order("created_at",{ascending:!1}).limit(100);!v&&u&&(a=a.eq("operator_id",u.id));let{data:b,error:c}=await a;!c&&b&&p(b),r(!1)},B=a.filter(a=>"all"===s||a.type===s),C=B.reduce((a,b)=>{let c=new Date(b.movement_date).toLocaleDateString("it-IT",{weekday:"long",day:"numeric",month:"long"});return a[c]||(a[c]=[]),a[c].push(b),a},{});return x?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)(n.Loader2,{className:"w-8 h-8 text-blue-600 animate-spin"})}):w?(0,b.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,b.jsx)(m.ShieldAlert,{className:"w-8 h-8 text-red-600"})}),(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Accesso Negato"}),(0,b.jsx)("p",{className:"text-gray-500 mb-4",children:"Non hai i permessi per accedere ai movimenti."}),(0,b.jsx)("button",{onClick:()=>z.push("/"),className:"px-4 py-2 bg-blue-600 text-white rounded-xl font-medium",children:"Torna alla Home"})]}):q?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):(0,b.jsxs)("div",{className:"min-h-screen",children:[(0,b.jsx)("header",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center gap-3",children:[(0,b.jsx)(o.default,{href:"/",className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,b.jsx)(k.ChevronLeft,{className:"w-5 h-5"})}),(0,b.jsx)(h.ClipboardList,{className:"w-6 h-6"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-bold",children:"Movimenti"}),(0,b.jsxs)("p",{className:"text-blue-100 text-sm",children:[a.length," operazioni",v&&(0,b.jsxs)("span",{className:"ml-2 inline-flex items-center gap-1",children:[(0,b.jsx)(l.Users,{className:"w-3 h-3"})," tutti"]})]})]})]})}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 -mt-4 mb-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)(o.default,{href:"/movimenti/carico?from=movimenti",className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:(0,b.jsx)(i.ArrowDownToLine,{className:"w-5 h-5 text-emerald-600"})}),(0,b.jsx)("span",{className:"font-semibold text-gray-900",children:"Carico"})]}),(0,b.jsxs)(o.default,{href:"/movimenti/scarico?from=movimenti",className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4 flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:(0,b.jsx)(j.ArrowUpFromLine,{className:"w-5 h-5 text-orange-600"})}),(0,b.jsx)("span",{className:"font-semibold text-gray-900",children:"Scarico"})]})]})}),(0,b.jsx)("div",{className:"max-w-4xl mx-auto px-4 mb-4",children:(0,b.jsx)("div",{className:"flex gap-2",children:["all","carico","scarico"].map(a=>(0,b.jsx)("button",{onClick:()=>t(a),className:(0,f.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all",s===a?"carico"===a?"bg-emerald-100 text-emerald-700":"scarico"===a?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"),children:"all"===a?"Tutti":"carico"===a?"Carichi":"Scarichi"},a))})}),(0,b.jsxs)("div",{className:"max-w-4xl mx-auto px-4 space-y-6 pb-6",children:[Object.entries(C).map(([a,c])=>(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2 capitalize",children:a}),(0,b.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,b.jsxs)("div",{className:(0,f.cn)("list-item border-l-4","carico"===a.type?"border-l-emerald-500":"border-l-orange-500"),children:[(0,b.jsx)("div",{className:(0,f.cn)("list-item-icon","carico"===a.type?"bg-emerald-100":"bg-orange-100"),children:"carico"===a.type?(0,b.jsx)(i.ArrowDownToLine,{className:(0,f.cn)("w-5 h-5","text-emerald-600")}):(0,b.jsx)(j.ArrowUpFromLine,{className:(0,f.cn)("w-5 h-5","text-orange-600")})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h4",{className:"font-semibold text-gray-900 truncate",children:a.product?.name}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["carico"===a.type?"+":"-",a.quantity," pz","scarico"===a.type&&a.worksite&&(0,b.jsxs)(b.Fragment,{children:[" → ",a.worksite.code]})]}),(0,b.jsxs)("p",{className:"text-xs text-gray-400",children:[a.operator?.full_name," • ",(0,f.formatDateTime)(a.created_at)]})]}),(0,b.jsxs)("span",{className:(0,f.cn)("font-bold","carico"===a.type?"text-emerald-600":"text-orange-600"),children:["carico"===a.type?"+":"-",(0,f.formatCurrency)(a.total_cost)]})]},a.id))})]},a)),0===B.length&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mb-4 text-gray-400",children:(0,b.jsx)(h.ClipboardList,{className:"w-8 h-8"})}),(0,b.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nessun movimento"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 max-w-sm",children:"I movimenti di magazzino appariranno qui"})]})]})]})}a.s(["default",()=>p])}];

//# sourceMappingURL=_7a442914._.js.map