(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let a=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>a],71689)},56909,e=>{"use strict";let a=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>a],56909)},63488,e=>{"use strict";let a=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>a],63488)},27612,e=>{"use strict";let a=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],27612)},7233,e=>{"use strict";let a=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],7233)},31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},55436,e=>{"use strict";let a=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],55436)},37727,e=>{"use strict";let a=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>a],37727)},88511,e=>{"use strict";let a=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>a],88511)},43432,e=>{"use strict";let a=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>a],43432)},15788,e=>{"use strict";let a=(0,e.i(75254).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["Truck",()=>a],15788)},65181,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(18566),r=e.i(11795),l=e.i(59897),i=e.i(15788),n=e.i(7233),o=e.i(55436),c=e.i(37727),d=e.i(43432),m=e.i(63488),x=e.i(88511),u=e.i(27612),h=e.i(71689),p=e.i(56909),b=e.i(31278),f=e.i(22016);function g(){let e=(0,s.useRouter)(),g=(0,s.useSearchParams)(),{isSuperuser:y}=(0,l.useAuth)(),j="impostazioni"===g.get("from"),[v,N]=(0,t.useState)([]),[w,k]=(0,t.useState)(!0),[M,C]=(0,t.useState)(""),[S,_]=(0,t.useState)(!1),[z,F]=(0,t.useState)(null),[L,A]=(0,t.useState)(!1),T=(0,r.createClient)(),[E,P]=(0,t.useState)({code:"",name:"",contact_name:"",email:"",phone:"",address:"",notes:""});(0,t.useEffect)(()=>{y?q():e.push("/impostazioni")},[y]);let q=async()=>{let{data:e}=await T.from("suppliers").select("*").order("code");e&&N(e),k(!1)},H=async()=>{let{data:e}=await T.from("suppliers").select("code").like("code","FOR%").order("code",{ascending:!1}).limit(1),a=1;return e&&e.length>0&&e[0].code&&(a=parseInt(e[0].code.replace("FOR",""),10)+1),`FOR${a.toString().padStart(3,"0")}`},R=async()=>{F(null),P({code:await H(),name:"",contact_name:"",email:"",phone:"",address:"",notes:""}),_(!0)},V=async e=>{if(e.preventDefault(),!E.name.trim())return void alert("Inserisci il nome del fornitore");if(A(!0),z){let{error:e}=await T.from("suppliers").update({name:E.name.trim(),contact_name:E.contact_name||null,email:E.email||null,phone:E.phone||null,address:E.address||null,notes:E.notes||null}).eq("id",z.id);e?alert("Errore durante il salvataggio: "+e.message):(_(!1),q())}else{let{error:e}=await T.from("suppliers").insert({code:E.code,name:E.name.trim(),contact_name:E.contact_name||null,email:E.email||null,phone:E.phone||null,address:E.address||null,notes:E.notes||null,is_active:!0});e?alert("Errore durante la creazione: "+e.message):(_(!1),q())}A(!1)},O=async e=>{if(!confirm(`Sei sicuro di voler eliminare "${e.name}"?`))return;let{error:a}=await T.from("suppliers").update({is_active:!1}).eq("id",e.id);a?alert("Errore durante l'eliminazione"):q()},$=v.filter(e=>{if(!e.is_active)return!1;if(!M.trim())return!0;let a=M.toLowerCase();return e.name.toLowerCase().includes(a)||e.code.toLowerCase().includes(a)||e.contact_name?.toLowerCase().includes(a)});return y?w?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-amber-600 border-t-transparent rounded-full animate-spin"})}):S?(0,a.jsxs)("div",{className:"min-h-screen pb-24",children:[(0,a.jsx)("header",{className:"bg-gradient-to-r from-amber-500 via-orange-500 to-amber-600 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("button",{onClick:()=>_(!1),className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,a.jsx)(h.ArrowLeft,{className:"w-5 h-5"})}),(0,a.jsx)("span",{className:"text-amber-100",children:z?"Modifica Fornitore":"Nuovo Fornitore"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center",children:(0,a.jsx)(i.Truck,{className:"w-7 h-7"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:z?E.name||"Modifica":"Nuovo Fornitore"}),(0,a.jsx)("p",{className:"text-amber-100 text-sm font-mono",children:E.code})]})]})]})}),(0,a.jsxs)("form",{onSubmit:V,className:"max-w-4xl mx-auto px-4 -mt-4 space-y-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Fornitore *"}),(0,a.jsx)("input",{type:"text",value:E.name,onChange:e=>P({...E,name:e.target.value}),placeholder:"Es. CleanPro Italia",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Persona di Contatto"}),(0,a.jsx)("input",{type:"text",value:E.contact_name,onChange:e=>P({...E,contact_name:e.target.value}),placeholder:"Es. Mario Rossi",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",value:E.email,onChange:e=>P({...E,email:e.target.value}),placeholder:"email@esempio.it",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefono"}),(0,a.jsx)("input",{type:"tel",value:E.phone,onChange:e=>P({...E,phone:e.target.value}),placeholder:"+39 02 1234567",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Indirizzo"}),(0,a.jsx)("input",{type:"text",value:E.address,onChange:e=>P({...E,address:e.target.value}),placeholder:"Via Roma 1, Milano",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),(0,a.jsx)("textarea",{value:E.notes,onChange:e=>P({...E,notes:e.target.value}),placeholder:"Note aggiuntive...",rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 resize-none"})]}),(0,a.jsx)("button",{type:"submit",disabled:L||!E.name.trim(),className:"w-full flex items-center justify-center gap-2 p-4 bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-2xl font-semibold hover:from-amber-600 hover:to-orange-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Loader2,{className:"w-5 h-5 animate-spin"}),"Salvataggio..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Save,{className:"w-5 h-5"}),z?"Salva Modifiche":"Crea Fornitore"]})})]})]}):(0,a.jsxs)("div",{className:"min-h-screen",children:[(0,a.jsx)("header",{className:"bg-gradient-to-r from-amber-500 via-orange-500 to-amber-600 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)(f.default,{href:j?"/impostazioni":"/",className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,a.jsx)(h.ArrowLeft,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Fornitori"}),(0,a.jsxs)("p",{className:"text-amber-100 text-sm",children:[$.length," fornitori attivi"]})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-amber-300"}),(0,a.jsx)("input",{type:"text",placeholder:"Cerca fornitore...",value:M,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-10 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white placeholder-amber-200 focus:outline-none focus:ring-2 focus:ring-white/30"}),M&&(0,a.jsx)("button",{onClick:()=>C(""),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-white/10 rounded-full",children:(0,a.jsx)(c.X,{className:"w-4 h-4 text-amber-200"})})]})]})}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 -mt-4 space-y-3 pb-24",children:[$.map((e,t)=>(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4 animate-slide-up",style:{animationDelay:`${.05*t}s`},children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"inline-block px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-semibold rounded-full",children:e.code}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mt-1",children:e.name}),e.contact_name&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.contact_name})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>{F(e),P({code:e.code,name:e.name,contact_name:e.contact_name||"",email:e.email||"",phone:e.phone||"",address:e.address||"",notes:e.notes||""}),_(!0)},className:"p-2 text-gray-400 hover:text-amber-600 hover:bg-amber-50 rounded-xl transition-colors",children:(0,a.jsx)(x.Edit,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>O(e),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-xl transition-colors",children:(0,a.jsx)(u.Trash2,{className:"w-5 h-5"})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500",children:[e.phone&&(0,a.jsxs)("a",{href:`tel:${e.phone}`,className:"flex items-center gap-1 hover:text-amber-600",children:[(0,a.jsx)(d.Phone,{className:"w-4 h-4"}),e.phone]}),e.email&&(0,a.jsxs)("a",{href:`mailto:${e.email}`,className:"flex items-center gap-1 hover:text-amber-600",children:[(0,a.jsx)(m.Mail,{className:"w-4 h-4"}),e.email]})]})]},e.id)),0===$.length&&M&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mb-4 text-gray-400",children:(0,a.jsx)(o.Search,{className:"w-8 h-8"})}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nessun risultato"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 max-w-sm",children:['Nessun fornitore trovato per "',M,'"']}),(0,a.jsx)("button",{onClick:()=>C(""),className:"mt-4 text-amber-600 font-medium",children:"Cancella ricerca"})]}),0===$.length&&!M&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mb-4 text-gray-400",children:(0,a.jsx)(i.Truck,{className:"w-8 h-8"})}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nessun fornitore"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 max-w-sm",children:"Aggiungi il primo fornitore per iniziare"})]})]}),(0,a.jsx)("button",{onClick:R,className:"fixed bottom-24 right-4 w-14 h-14 rounded-full bg-gradient-to-r from-amber-500 to-orange-500 text-white shadow-xl flex items-center justify-center z-50 hover:from-amber-600 hover:to-orange-600 active:scale-95 transition-all duration-200",children:(0,a.jsx)(n.Plus,{className:"w-6 h-6"})})]}):null}function y(){return(0,a.jsx)(t.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(b.Loader2,{className:"w-8 h-8 text-amber-600 animate-spin"})}),children:(0,a.jsx)(g,{})})}e.s(["default",()=>y])}]);