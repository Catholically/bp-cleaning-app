(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},51737,e=>{"use strict";let t=(0,e.i(75254).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);e.s(["ShieldAlert",()=>t],51737)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},27639,e=>{"use strict";let t={detergente:"consumabile",sgrassatore:"consumabile",disinfettante:"consumabile",lucidante:"consumabile",deodorante:"consumabile",accessorio:"attrezzatura",attrezzatura:"attrezzatura",altro:"attrezzatura"};e.s(["CATEGORIES_BY_TYPE",0,{all:["detergente","sgrassatore","disinfettante","lucidante","deodorante","accessorio","attrezzatura","altro"],consumabile:["detergente","sgrassatore","disinfettante","lucidante","deodorante"],attrezzatura:["accessorio","attrezzatura","altro"]},"CATEGORY_ICONS",0,{detergente:"ðŸ§´",sgrassatore:"ðŸ’ª",disinfettante:"ðŸ§¹",lucidante:"âœ¨",deodorante:"ðŸŒ¸",accessorio:"ðŸ§¤",attrezzatura:"ðŸ› ï¸",altro:"ðŸ“¦"},"CATEGORY_LABELS",0,{detergente:"Detergente",sgrassatore:"Sgrassatore",disinfettante:"Disinfettante",lucidante:"Lucidante",deodorante:"Deodorante",accessorio:"Accessorio",attrezzatura:"Attrezzatura",altro:"Altro"},"STATUS_LABELS",0,{active:"Attivo",paused:"In pausa",completed:"Completato"},"UNIT_LABELS",0,{litri:"Litri",pezzi:"Pezzi",kg:"Kg",ml:"ml",rotoli:"Rotoli",confezioni:"Confezioni"},"filterProductsByType",0,(e,a)=>"all"===a?e:e.filter(e=>t[e.category]===a)])},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},42872,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(11795),o=e.i(59897),l=e.i(27639),i=e.i(71689),n=e.i(88844),d=e.i(56909),c=e.i(31278),u=e.i(51737),m=e.i(27612);function x(){let e=(0,r.useParams)(),x=(0,r.useRouter)(),{isSuperuser:g,loading:b}=(0,o.useAuth)(),p=(0,s.createClient)(),[h,f]=(0,a.useState)(!0),[y,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[w,z]=(0,a.useState)(null),[k,S]=(0,a.useState)([]),[C,A]=(0,a.useState)(""),[_,E]=(0,a.useState)(""),[L,M]=(0,a.useState)(""),[T,P]=(0,a.useState)("detergente"),[B,O]=(0,a.useState)("pezzi"),[U,q]=(0,a.useState)(1),[R,D]=(0,a.useState)(0),[I,V]=(0,a.useState)(0),[F,G]=(0,a.useState)(5),[Y,H]=(0,a.useState)(""),[K,Q]=(0,a.useState)("");(0,a.useEffect)(()=>{e.id&&!b&&g&&$()},[e.id,b,g]);let $=async()=>{let{data:t,error:a}=await p.from("products").select("*").eq("id",e.id).single();if(a||!t)return void x.push("/prodotti");z(t),A(t.sku||""),E(t.barcode||""),M(t.name||""),P(t.category||"detergente"),O(t.unit||"pezzi"),q(t.quantity_per_package||1),D(t.unit_cost||0),V(t.current_stock||0),G(t.min_stock||5),H(t.supplier_id||""),Q(t.notes||"");let{data:r}=await p.from("suppliers").select("*").eq("is_active",!0).order("name");r&&S(r),f(!1)},J=async t=>{if(t.preventDefault(),!L.trim())return void alert("Inserisci il nome del prodotto");v(!0);try{let{error:t}=await p.from("products").update({name:L.trim(),category:T,unit:B,quantity_per_package:U,unit_cost:R,current_stock:I,min_stock:F,supplier_id:Y||null,notes:K.trim()||null}).eq("id",e.id);t?(console.error("Error updating product:",t),alert("Errore durante il salvataggio: "+t.message)):x.push(`/prodotti/${e.id}`)}catch(e){console.error("Error:",e),alert("Errore durante il salvataggio")}finally{v(!1)}},W=async()=>{if(!w)return;let{count:t}=await p.from("movements").select("*",{count:"exact",head:!0}).eq("product_id",e.id);if(t&&t>0){if(!confirm(`Questo prodotto ha ${t} movimenti associati. Vuoi disattivarlo? Il prodotto non sar\xe0 pi\xf9 visibile ma i dati storici saranno mantenuti.`))return}else if(!confirm(`Sei sicuro di voler eliminare "${w.name}"? Questa azione non pu\xf2 essere annullata.`))return;N(!0);try{let{error:t}=await p.from("products").update({is_active:!1}).eq("id",e.id);t?(console.error("Error deleting product:",t),alert("Errore durante l'eliminazione: "+t.message)):x.push("/prodotti")}catch(e){console.error("Error:",e),alert("Errore durante l'eliminazione")}finally{N(!1)}};return b||h?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(c.Loader2,{className:"w-8 h-8 text-blue-600 animate-spin"})}):g?w?(0,t.jsxs)("div",{className:"min-h-screen pb-24",children:[(0,t.jsx)("header",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("button",{onClick:()=>x.back(),className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,t.jsx)(i.ArrowLeft,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"text-blue-100",children:"Modifica Prodotto"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center",children:(0,t.jsx)(n.Package,{className:"w-7 h-7"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-blue-200 text-xs font-mono",children:C}),(0,t.jsx)("h1",{className:"text-xl font-bold",children:w.name})]})]})]})}),(0,t.jsxs)("form",{onSubmit:J,className:"max-w-4xl mx-auto px-4 -mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl border border-gray-200 p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"SKU (non modificabile)"}),(0,t.jsx)("input",{type:"text",value:C,disabled:!0,className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-500 bg-gray-100 cursor-not-allowed font-mono text-sm"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl border border-gray-200 p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Barcode (non modificabile)"}),(0,t.jsx)("input",{type:"text",value:_,disabled:!0,className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-500 bg-gray-100 cursor-not-allowed font-mono text-sm"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Prodotto *"}),(0,t.jsx)("input",{type:"text",value:L,onChange:e=>M(e.target.value),placeholder:"Es. Detergente Multiuso 5L",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),(0,t.jsx)("select",{value:T,onChange:e=>P(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(l.CATEGORY_LABELS).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unita"}),(0,t.jsx)("select",{value:B,onChange:e=>O(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(l.UNIT_LABELS).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"QtÃ  per Conf."}),(0,t.jsx)("input",{type:"number",value:U,onChange:e=>q(Number(e.target.value)),min:"1",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario â‚¬"}),(0,t.jsx)("input",{type:"number",value:R,onChange:e=>D(Number(e.target.value)),min:"0",step:"0.01",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Giacenza Attuale"}),(0,t.jsx)("input",{type:"number",value:I,onChange:e=>V(Number(e.target.value)),min:"0",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,t.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Usa i movimenti per aggiornare la giacenza"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scorta Minima"}),(0,t.jsx)("input",{type:"number",value:F,onChange:e=>G(Number(e.target.value)),min:"0",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fornitore"}),(0,t.jsxs)("select",{value:Y,onChange:e=>H(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"",children:"-- Nessun fornitore --"}),k.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (opzionale)"}),(0,t.jsx)("textarea",{value:K,onChange:e=>Q(e.target.value),placeholder:"Note aggiuntive...",rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{type:"submit",disabled:y||!L.trim(),className:"w-full flex items-center justify-center gap-2 p-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-2xl font-semibold hover:from-blue-700 hover:to-blue-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"w-5 h-5 animate-spin"}),"Salvataggio..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Save,{className:"w-5 h-5"}),"Salva Modifiche"]})}),(0,t.jsx)("button",{type:"button",onClick:W,disabled:j,className:"w-full flex items-center justify-center gap-2 p-4 bg-white border-2 border-red-200 text-red-600 rounded-2xl font-semibold hover:bg-red-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"w-5 h-5 animate-spin"}),"Disattivazione..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Trash2,{className:"w-5 h-5"}),"Disattiva Prodotto"]})})]})]})]}):null:(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)(u.ShieldAlert,{className:"w-8 h-8 text-red-600"})}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Accesso Negato"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"Solo i superuser possono modificare i prodotti."}),(0,t.jsx)("button",{onClick:()=>x.push("/prodotti"),className:"px-4 py-2 bg-blue-600 text-white rounded-xl font-medium",children:"Torna ai Prodotti"})]})}e.s(["default",()=>x])}]);