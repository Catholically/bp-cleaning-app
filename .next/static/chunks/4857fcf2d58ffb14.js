(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73375,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},51737,e=>{"use strict";let t=(0,e.i(75254).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);e.s(["ShieldAlert",()=>t],51737)},35956,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-up-from-line",[["path",{d:"m18 9-6-6-6 6",key:"kcunyi"}],["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 21h14",key:"11awu3"}]]);e.s(["ArrowUpFromLine",()=>t],35956)},28480,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-down-to-line",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);e.s(["ArrowDownToLine",()=>t],28480)},61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},46012,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(11795),i=e.i(75157),l=e.i(59897),c=e.i(91741),n=e.i(28480),d=e.i(35956),o=e.i(73375),m=e.i(61911),x=e.i(51737),h=e.i(31278),u=e.i(22016);function p(){let[e,p]=(0,s.useState)([]),[f,g]=(0,s.useState)(!0),[j,y]=(0,s.useState)("all"),{user:b,isSuperuser:N,isManager:w,loading:v}=(0,l.useAuth)(),k=(0,r.createClient)(),C=(0,a.useRouter)();(0,s.useEffect)(()=>{!v&&w&&C.replace("/")},[w,v,C]),(0,s.useEffect)(()=>{b&&!w&&L()},[b,N,w]);let L=async()=>{let e=k.from("movements").select(`
        *,
        product:products(name, unit),
        worksite:worksites(code, name),
        operator:profiles(full_name)
      `).order("created_at",{ascending:!1}).limit(100);!N&&b&&(e=e.eq("operator_id",b.id));let{data:t,error:s}=await e;!s&&t&&p(t),g(!1)},A=e.filter(e=>"all"===j||e.type===j),M=A.reduce((e,t)=>{let s=new Date(t.created_at).toLocaleDateString("it-IT",{weekday:"long",day:"numeric",month:"long"});return e[s]||(e[s]=[]),e[s].push(t),e},{});return v?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(h.Loader2,{className:"w-8 h-8 text-blue-600 animate-spin"})}):w?(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)(x.ShieldAlert,{className:"w-8 h-8 text-red-600"})}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Accesso Negato"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"Non hai i permessi per accedere ai movimenti."}),(0,t.jsx)("button",{onClick:()=>C.push("/"),className:"px-4 py-2 bg-blue-600 text-white rounded-xl font-medium",children:"Torna alla Home"})]}):f?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)("header",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center gap-3",children:[(0,t.jsx)(u.default,{href:"/",className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,t.jsx)(o.ChevronLeft,{className:"w-5 h-5"})}),(0,t.jsx)(c.ClipboardList,{className:"w-6 h-6"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Movimenti"}),(0,t.jsxs)("p",{className:"text-blue-100 text-sm",children:[e.length," operazioni",N&&(0,t.jsxs)("span",{className:"ml-2 inline-flex items-center gap-1",children:[(0,t.jsx)(m.Users,{className:"w-3 h-3"})," tutti"]})]})]})]})}),(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 -mt-4 mb-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)(u.default,{href:"/movimenti/carico?from=movimenti",className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(n.ArrowDownToLine,{className:"w-5 h-5 text-emerald-600"})}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:"Carico"})]}),(0,t.jsxs)(u.default,{href:"/movimenti/scarico?from=movimenti",className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center",children:(0,t.jsx)(d.ArrowUpFromLine,{className:"w-5 h-5 text-orange-600"})}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:"Scarico"})]})]})}),(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 mb-4",children:(0,t.jsx)("div",{className:"flex gap-2",children:["all","carico","scarico"].map(e=>(0,t.jsx)("button",{onClick:()=>y(e),className:(0,i.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all",j===e?"carico"===e?"bg-emerald-100 text-emerald-700":"scarico"===e?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600"),children:"all"===e?"Tutti":"carico"===e?"Carichi":"Scarichi"},e))})}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 space-y-6 pb-6",children:[Object.entries(M).map(([e,s])=>(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2 capitalize",children:e}),(0,t.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,t.jsxs)("div",{className:(0,i.cn)("list-item border-l-4","carico"===e.type?"border-l-emerald-500":"border-l-orange-500"),children:[(0,t.jsx)("div",{className:(0,i.cn)("list-item-icon","carico"===e.type?"bg-emerald-100":"bg-orange-100"),children:"carico"===e.type?(0,t.jsx)(n.ArrowDownToLine,{className:(0,i.cn)("w-5 h-5","text-emerald-600")}):(0,t.jsx)(d.ArrowUpFromLine,{className:(0,i.cn)("w-5 h-5","text-orange-600")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 truncate",children:e.product?.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["carico"===e.type?"+":"-",e.quantity," pz","scarico"===e.type&&e.worksite&&(0,t.jsxs)(t.Fragment,{children:[" → ",e.worksite.code]})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:[e.operator?.full_name," • ",(0,i.formatDateTime)(e.created_at)]})]}),(0,t.jsxs)("span",{className:(0,i.cn)("font-bold","carico"===e.type?"text-emerald-600":"text-orange-600"),children:["carico"===e.type?"+":"-",(0,i.formatCurrency)(e.total_cost)]})]},e.id))})]},e)),0===A.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mb-4 text-gray-400",children:(0,t.jsx)(c.ClipboardList,{className:"w-8 h-8"})}),(0,t.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nessun movimento"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 max-w-sm",children:"I movimenti di magazzino appariranno qui"})]})]})]})}e.s(["default",()=>p])}]);