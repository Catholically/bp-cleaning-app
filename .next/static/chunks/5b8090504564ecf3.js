(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},27639,e=>{"use strict";let t={detergente:"consumabile",sgrassatore:"consumabile",disinfettante:"consumabile",lucidante:"consumabile",deodorante:"consumabile",accessorio:"attrezzatura",attrezzatura:"attrezzatura",altro:"attrezzatura"};e.s(["CATEGORIES_BY_TYPE",0,{all:["detergente","sgrassatore","disinfettante","lucidante","deodorante","accessorio","attrezzatura","altro"],consumabile:["detergente","sgrassatore","disinfettante","lucidante","deodorante"],attrezzatura:["accessorio","attrezzatura","altro"]},"CATEGORY_ICONS",0,{detergente:"ðŸ§´",sgrassatore:"ðŸ’ª",disinfettante:"ðŸ§¹",lucidante:"âœ¨",deodorante:"ðŸŒ¸",accessorio:"ðŸ§¤",attrezzatura:"ðŸ› ï¸",altro:"ðŸ“¦"},"CATEGORY_LABELS",0,{detergente:"Detergente",sgrassatore:"Sgrassatore",disinfettante:"Disinfettante",lucidante:"Lucidante",deodorante:"Deodorante",accessorio:"Accessorio",attrezzatura:"Attrezzatura",altro:"Altro"},"STATUS_LABELS",0,{active:"Attivo",paused:"In pausa",completed:"Completato"},"UNIT_LABELS",0,{litri:"Litri",pezzi:"Pezzi",kg:"Kg",ml:"ml",rotoli:"Rotoli",confezioni:"Confezioni"},"filterProductsByType",0,(e,a)=>"all"===a?e:e.filter(e=>t[e.category]===a)])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},99189,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(11795),o=e.i(59897),l=e.i(27639),i=e.i(71689),n=e.i(88844),d=e.i(56909),c=e.i(31278);function u(){let e=(0,r.useRouter)(),{isSuperuser:u}=(0,o.useAuth)(),m=(0,s.createClient)(),[g,x]=(0,a.useState)(!1),[b,p]=(0,a.useState)([]),[h,f]=(0,a.useState)(!0),[y,j]=(0,a.useState)(""),[v,N]=(0,a.useState)("detergente"),[w,z]=(0,a.useState)("pezzi"),[S,C]=(0,a.useState)(1),[k,A]=(0,a.useState)(0),[E,L]=(0,a.useState)(0),[T,B]=(0,a.useState)(5),[P,_]=(0,a.useState)(""),[I,O]=(0,a.useState)("");(0,a.useEffect)(()=>{u?D():e.push("/prodotti")},[u]);let D=async()=>{let{data:e}=await m.from("suppliers").select("*").eq("is_active",!0).order("name");e&&p(e),f(!1)},R=async e=>{let t={detergente:"DET",sgrassatore:"SGR",disinfettante:"DIS",lucidante:"LUC",deodorante:"DEO",accessorio:"ACC",attrezzatura:"ATT",altro:"ALT"}[e],{data:a}=await m.from("products").select("sku").like("sku",`BP-${t}%`).order("sku",{ascending:!1}).limit(1),r=1;return a&&a.length>0&&a[0].sku&&(r=parseInt(a[0].sku.replace(`BP-${t}`,""),10)+1),`BP-${t}${r.toString().padStart(3,"0")}`},U=async()=>{let{data:e}=await m.from("products").select("barcode").like("barcode","BPC%").order("barcode",{ascending:!1}).limit(1),t=1;return e&&e.length>0&&e[0].barcode&&(t=parseInt(e[0].barcode.substring(3),10)+1),`BPC${t.toString().padStart(5,"0")}`},M=async t=>{if(t.preventDefault(),!y.trim())return void alert("Inserisci il nome del prodotto");x(!0);try{let t=await R(v),a=await U(),{error:r}=await m.from("products").insert({sku:t,barcode:a,name:y.trim(),category:v,unit:w,quantity_per_package:S,unit_cost:k,current_stock:E,min_stock:T,supplier_id:P||null,notes:I||null,is_active:!0});r?(console.error("Error creating product:",r),alert("Errore durante la creazione: "+r.message)):e.push("/prodotti")}catch(e){console.error("Error:",e),alert("Errore durante la creazione")}finally{x(!1)}};return u?(0,t.jsxs)("div",{className:"min-h-screen pb-24",children:[(0,t.jsx)("header",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("button",{onClick:()=>e.back(),className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,t.jsx)(i.ArrowLeft,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"text-blue-100",children:"Nuovo Prodotto"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center",children:(0,t.jsx)(n.Package,{className:"w-7 h-7"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Aggiungi Prodotto"}),(0,t.jsx)("p",{className:"text-blue-100 text-sm",children:"Compila i dettagli"})]})]})]})}),(0,t.jsxs)("form",{onSubmit:M,className:"max-w-4xl mx-auto px-4 -mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Prodotto *"}),(0,t.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"Es. Detergente Multiuso 5L",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),(0,t.jsx)("select",{value:v,onChange:e=>N(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(l.CATEGORY_LABELS).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unita"}),(0,t.jsx)("select",{value:w,onChange:e=>z(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(l.UNIT_LABELS).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"QtÃ  per Conf."}),(0,t.jsx)("input",{type:"number",value:S,onChange:e=>C(Number(e.target.value)),min:"1",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario â‚¬"}),(0,t.jsx)("input",{type:"number",value:k,onChange:e=>A(Number(e.target.value)),min:"0",step:"0.01",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Giacenza Iniziale"}),(0,t.jsx)("input",{type:"number",value:E,onChange:e=>L(Number(e.target.value)),min:"0",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scorta Minima"}),(0,t.jsx)("input",{type:"number",value:T,onChange:e=>B(Number(e.target.value)),min:"0",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fornitore"}),h?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 py-3",children:[(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}),"Caricamento..."]}):(0,t.jsxs)("select",{value:P,onChange:e=>_(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"",children:"-- Nessun fornitore --"}),b.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 rounded-2xl border border-blue-100 p-4",children:[(0,t.jsx)("p",{className:"text-sm text-blue-800 font-medium mb-1",children:"Codici generati automaticamente"}),(0,t.jsx)("p",{className:"text-xs text-blue-600",children:"SKU: BP-XXX001 (es. BP-DET001) â€¢ Barcode: BPC00001"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (opzionale)"}),(0,t.jsx)("textarea",{value:I,onChange:e=>O(e.target.value),placeholder:"Note aggiuntive...",rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,t.jsx)("button",{type:"submit",disabled:g||!y.trim(),className:"w-full flex items-center justify-center gap-2 p-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-2xl font-semibold hover:from-blue-700 hover:to-blue-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"w-5 h-5 animate-spin"}),"Salvataggio..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Save,{className:"w-5 h-5"}),"Crea Prodotto"]})})]})]}):null}e.s(["default",()=>u])}]);