(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,27639,e=>{"use strict";let t={detergente:"consumabile",sgrassatore:"consumabile",disinfettante:"consumabile",lucidante:"consumabile",deodorante:"consumabile",accessorio:"attrezzatura",attrezzatura:"attrezzatura",altro:"attrezzatura"};e.s(["CATEGORIES_BY_TYPE",0,{all:["detergente","sgrassatore","disinfettante","lucidante","deodorante","accessorio","attrezzatura","altro"],consumabile:["detergente","sgrassatore","disinfettante","lucidante","deodorante"],attrezzatura:["accessorio","attrezzatura","altro"]},"CATEGORY_ICONS",0,{detergente:"ðŸ§´",sgrassatore:"ðŸ’ª",disinfettante:"ðŸ§¹",lucidante:"âœ¨",deodorante:"ðŸŒ¸",accessorio:"ðŸ§¤",attrezzatura:"ðŸ› ï¸",altro:"ðŸ“¦"},"CATEGORY_LABELS",0,{detergente:"Detergente",sgrassatore:"Sgrassatore",disinfettante:"Disinfettante",lucidante:"Lucidante",deodorante:"Deodorante",accessorio:"Accessorio",attrezzatura:"Attrezzatura",altro:"Altro"},"STATUS_LABELS",0,{active:"Attivo",paused:"In pausa",completed:"Completato"},"UNIT_LABELS",0,{litri:"Litri",pezzi:"Pezzi",kg:"Kg",ml:"ml",rotoli:"Rotoli",confezioni:"Confezioni"},"filterProductsByType",0,(e,a)=>"all"===a?e:e.filter(e=>t[e.category]===a)])},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},55900,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["ChevronUp",()=>t],55900)},73375,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},83086,95116,4499,34343,e=>{"use strict";var t=e.i(75254);let a=(0,t.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);e.s(["Sparkles",()=>a],83086);let r=(0,t.default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]);e.s(["Wrench",()=>r],95116);let s=(0,t.default)("scan-barcode",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 7v10",key:"23sfjj"}],["path",{d:"M12 7v10",key:"jspqdw"}],["path",{d:"M17 7v10",key:"578dap"}]]);e.s(["ScanBarcode",()=>s],4499);var l=e.i(71645);function n(){let[e,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=()=>{let e="ontouchstart"in window||navigator.maxTouchPoints>0,a=window.innerWidth<768;t(e&&a)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}function i({onScan:e,enabled:t=!0,minLength:a=5,maxDelay:r=50}){let s=(0,l.useRef)(""),n=(0,l.useRef)(0),i=(0,l.useRef)(null),o=(0,l.useCallback)(()=>{s.current="",i.current&&(clearTimeout(i.current),i.current=null)},[]),c=(0,l.useCallback)(()=>{let t=s.current.trim();t.length>=a&&(console.log("[BarcodeScanner] Detected barcode:",t),e(t)),o()},[a,e,o]);return(0,l.useEffect)(()=>{if(!t)return;let e=e=>{let t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return;let l=Date.now();if(l-n.current>r&&s.current.length>0&&o(),"Enter"===e.key){e.preventDefault(),c();return}1!==e.key.length||e.ctrlKey||e.altKey||e.metaKey||(s.current+=e.key,n.current=l,i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{s.current.length>=a?c():o()},100))};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e),i.current&&clearTimeout(i.current)}},[t,r,a,c,o]),{resetBuffer:o}}e.s(["useBarcodeScanner",()=>i,"useIsMobile",()=>n],34343)},87130,e=>{"use strict";let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],87130)},78854,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(11795),s=e.i(59897),l=e.i(75157),n=e.i(27639),i=e.i(55436),o=e.i(7233),c=e.i(87130),d=e.i(88844),u=e.i(43531),m=e.i(83086),x=e.i(95116),h=e.i(64659),b=e.i(55900),g=e.i(73375),p=e.i(4499),f=e.i(22016),y=e.i(18566),w=e.i(34343);function j(){let{isSuperuser:e}=(0,s.useAuth)(),j=(0,y.useRouter)(),v=(0,y.useSearchParams)(),[N,k]=(0,a.useState)([]),[z,C]=(0,a.useState)(!0),[S,T]=(0,a.useState)(""),[A,E]=(0,a.useState)("low"===v.get("filter")),[L,_]=(0,a.useState)("all"),[P,M]=(0,a.useState)(null),[R,B]=(0,a.useState)(null),[O,I]=(0,a.useState)(null),[D,Y]=(0,a.useState)(null),q=(0,r.createClient)(),U=(0,w.useIsMobile)(),G=(0,a.useCallback)(e=>{let t=N.find(t=>t.barcode===e);t?(Y(e),setTimeout(()=>{j.push(`/prodotti/${t.id}`)},300)):(I(`Prodotto non trovato: ${e}`),setTimeout(()=>I(null),3e3))},[N,j]);(0,w.useBarcodeScanner)({onScan:G,enabled:N.length>0&&!U,minLength:5}),(0,a.useEffect)(()=>{let e=!0;return(async()=>{try{await K()}finally{e&&C(!1)}})(),()=>{e=!1}},[]);let K=async()=>{let{data:e,error:t}=await q.from("products").select("*, supplier:suppliers(name)").eq("is_active",!0).order("category").order("name");!t&&e&&k(e)},$=(0,a.useMemo)(()=>{let e=N;return R?e=N.filter(e=>e.category===R):"all"!==L&&(e=(0,n.filterProductsByType)(N,L)),e.filter(e=>{let t=!S||e.name.toLowerCase().includes(S.toLowerCase())||e.barcode?.toLowerCase().includes(S.toLowerCase()),a=!A||e.current_stock<=e.min_stock;return t&&a})},[N,S,A,L,R]),W=e=>{"all"===e?(_("all"),M(null),B(null)):P===e?(M(null),B(null),_(e)):(_(e),M(e),B(null))};return z?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)("header",{className:"bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center gap-3",children:[(0,t.jsx)(f.default,{href:"/",className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,t.jsx)(g.ChevronLeft,{className:"w-5 h-5"})}),(0,t.jsx)(d.Package,{className:"w-6 h-6"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Prodotti"}),(0,t.jsxs)("p",{className:"text-blue-100 text-sm",children:[N.length," prodotti in magazzino"]})]})]})}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 -mt-4 space-y-3",children:[!U&&(0,t.jsxs)("div",{className:(0,l.cn)("flex items-center gap-3 p-3 rounded-xl border-2 transition-all",D?"bg-emerald-50 border-emerald-500":O?"bg-red-50 border-red-300":"bg-blue-50 border-blue-200"),children:[(0,t.jsx)("div",{className:(0,l.cn)("w-8 h-8 rounded-lg flex items-center justify-center",D?"bg-emerald-500 text-white":O?"bg-red-500 text-white":"bg-blue-500 text-white"),children:(0,t.jsx)(p.ScanBarcode,{className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 truncate",children:D?`Trovato: ${D}`:O||"Pistola barcode pronta"})}),D&&(0,t.jsx)(u.Check,{className:"w-5 h-5 text-emerald-500 flex-shrink-0"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(i.Search,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Cerca prodotto...",value:S,onChange:e=>T(e.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-200 bg-white text-gray-900 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent pl-12"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>W("all"),className:(0,l.cn)("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all","all"!==L||R?"bg-white text-gray-600 border border-gray-200":"bg-blue-100 text-blue-700 border border-blue-200"),children:[(0,t.jsx)(d.Package,{className:"w-4 h-4"}),"Tutti"]}),(0,t.jsxs)("button",{onClick:()=>W("consumabile"),className:(0,l.cn)("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all","consumabile"===L?"bg-emerald-100 text-emerald-700 border border-emerald-200":"bg-white text-gray-600 border border-gray-200"),children:[(0,t.jsx)(m.Sparkles,{className:"w-4 h-4"}),"Pulizia","consumabile"===P?(0,t.jsx)(b.ChevronUp,{className:"w-3 h-3 ml-1"}):(0,t.jsx)(h.ChevronDown,{className:"w-3 h-3 ml-1"})]}),(0,t.jsxs)("button",{onClick:()=>W("attrezzatura"),className:(0,l.cn)("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all","attrezzatura"===L?"bg-amber-100 text-amber-700 border border-amber-200":"bg-white text-gray-600 border border-gray-200"),children:[(0,t.jsx)(x.Wrench,{className:"w-4 h-4"}),"Attrezz.","attrezzatura"===P?(0,t.jsx)(b.ChevronUp,{className:"w-3 h-3 ml-1"}):(0,t.jsx)(h.ChevronDown,{className:"w-3 h-3 ml-1"})]})]}),P&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 animate-slide-up",children:n.CATEGORIES_BY_TYPE[P].map(e=>(0,t.jsxs)("button",{onClick:()=>{R===e?B(null):B(e)},className:(0,l.cn)("flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all",R===e?"consumabile"===P?"bg-emerald-500 text-white":"bg-amber-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[(0,t.jsx)("span",{children:n.CATEGORY_ICONS[e]}),n.CATEGORY_LABELS[e]]},e))})]}),(0,t.jsxs)("button",{onClick:()=>E(!A),className:(0,l.cn)("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all",A?"bg-red-100 text-red-700 border border-red-200":"bg-white text-gray-600 border border-gray-200"),children:[(0,t.jsx)(c.Filter,{className:"w-4 h-4"}),"Solo scorte basse"]})]}),(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 mt-4 space-y-3 pb-6",children:0===$.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mb-4 text-gray-400",children:(0,t.jsx)(d.Package,{className:"w-8 h-8"})}),(0,t.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nessun prodotto trovato"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 max-w-sm",children:S?"Prova con una ricerca diversa":"Aggiungi il primo prodotto"})]}):$.map((e,a)=>{let r,s=(r=e.current_stock/e.min_stock)<=1?{color:"text-red-500",bg:"bg-red-50",label:"RIORDINO"}:r<=1.5?{color:"text-amber-500",bg:"bg-amber-50",label:"BASSO"}:{color:"text-emerald-500",bg:"bg-emerald-50",label:"OK"};return(0,t.jsxs)(f.default,{href:`/prodotti/${e.id}`,className:"flex items-center gap-4 p-4 bg-white rounded-2xl border border-gray-100 shadow-sm transition-all duration-200 hover:shadow-md hover:border-gray-200 animate-slide-up",style:{animationDelay:`${.03*a}s`},children:[(0,t.jsx)("div",{className:(0,l.cn)("list-item-icon",s.bg),children:(0,t.jsx)("span",{className:"text-xl",children:n.CATEGORY_ICONS[e.category]})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.quantity_per_package,e.unit," â€¢ ",(0,l.formatCurrency)(e.unit_cost)]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:(0,l.cn)("text-lg font-bold",s.color),children:(0,l.formatNumber)(e.current_stock,0)}),e.current_stock<=e.min_stock?(0,t.jsx)("span",{className:"badge-danger text-[10px]",children:s.label}):(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"in stock"})]})]},e.id)})}),e&&(0,t.jsx)(f.default,{href:"/prodotti/nuovo",className:"fixed bottom-24 right-4 w-14 h-14 rounded-full bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-xl flex items-center justify-center z-50 hover:from-blue-700 hover:to-blue-800 active:scale-95 transition-all duration-200",children:(0,t.jsx)(o.Plus,{className:"w-6 h-6"})})]})}function v(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}),children:(0,t.jsx)(j,{})})}e.s(["default",()=>v])}]);