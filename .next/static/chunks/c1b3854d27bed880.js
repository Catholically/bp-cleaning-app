(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},51737,e=>{"use strict";let t=(0,e.i(75254).default)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);e.s(["ShieldAlert",()=>t],51737)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},27639,e=>{"use strict";let t={detergente:"consumabile",sgrassatore:"consumabile",disinfettante:"consumabile",lucidante:"consumabile",deodorante:"consumabile",accessorio:"attrezzatura",attrezzatura:"attrezzatura",altro:"attrezzatura"};e.s(["CATEGORIES_BY_TYPE",0,{all:["detergente","sgrassatore","disinfettante","lucidante","deodorante","accessorio","attrezzatura","altro"],consumabile:["detergente","sgrassatore","disinfettante","lucidante","deodorante"],attrezzatura:["accessorio","attrezzatura","altro"]},"CATEGORY_ICONS",0,{detergente:"ðŸ§´",sgrassatore:"ðŸ’ª",disinfettante:"ðŸ§¹",lucidante:"âœ¨",deodorante:"ðŸŒ¸",accessorio:"ðŸ§¤",attrezzatura:"ðŸ› ï¸",altro:"ðŸ“¦"},"CATEGORY_LABELS",0,{detergente:"Detergente",sgrassatore:"Sgrassatore",disinfettante:"Disinfettante",lucidante:"Lucidante",deodorante:"Deodorante",accessorio:"Accessorio",attrezzatura:"Attrezzatura",altro:"Altro"},"STATUS_LABELS",0,{active:"Attivo",paused:"In pausa",completed:"Completato"},"UNIT_LABELS",0,{litri:"Litri",pezzi:"Pezzi",kg:"Kg",ml:"ml",rotoli:"Rotoli",confezioni:"Confezioni"},"filterProductsByType",0,(e,a)=>"all"===a?e:e.filter(e=>t[e.category]===a)])},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},4361,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(11795),l=e.i(59897),i=e.i(27639),o=e.i(71689),n=e.i(7486),d=e.i(56909),c=e.i(31278),u=e.i(51737),m=e.i(27612);function x(){let e=(0,r.useParams)(),x=(0,r.useRouter)(),{isSuperuser:g,loading:p}=(0,l.useAuth)(),h=(0,s.createClient)(),[b,f]=(0,a.useState)(!0),[y,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[w,S]=(0,a.useState)(null),[z,k]=(0,a.useState)(""),[C,A]=(0,a.useState)(""),[E,_]=(0,a.useState)(""),[M,T]=(0,a.useState)(""),[L,R]=(0,a.useState)(""),[B,I]=(0,a.useState)(""),[P,q]=(0,a.useState)(""),[U,V]=(0,a.useState)(""),[O,D]=(0,a.useState)(""),[F,H]=(0,a.useState)(""),[Y,G]=(0,a.useState)(""),[K,$]=(0,a.useState)(""),[Q,J]=(0,a.useState)(0),[W,X]=(0,a.useState)("active"),[Z,ee]=(0,a.useState)("");(0,a.useEffect)(()=>{e.id&&!p&&g&&et()},[e.id,p,g]);let et=async()=>{let{data:t,error:a}=await h.from("worksites").select("*").eq("id",e.id).single();a||!t?x.push("/cantieri"):(S(t),k(t.code||""),A(t.name||""),_(t.address||""),T(t.city||""),R(t.cap||""),I(t.provincia||""),q(t.client_name||""),V(t.client_contact||""),D(t.client_phone||""),H(t.client_email||""),G(t.codice_fiscale||""),$(t.partita_iva||""),J(t.budget_allocated||0),X(t.status||"active"),ee(t.notes||""),f(!1))},ea=async t=>{if(t.preventDefault(),!C.trim())return void alert("Inserisci il nome del cantiere");if(!E.trim()||!M.trim())return void alert("Inserisci indirizzo e cittÃ ");v(!0);try{let{error:t}=await h.from("worksites").update({name:C.trim(),address:E.trim(),city:M.trim(),cap:L.trim()||null,provincia:B.trim()||null,client_name:P.trim()||null,client_contact:U.trim()||null,client_phone:O.trim()||null,client_email:F.trim()||null,codice_fiscale:Y.trim()||null,partita_iva:K.trim()||null,budget_allocated:Q,status:W,notes:Z.trim()||null}).eq("id",e.id);t?(console.error("Error updating worksite:",t),alert("Errore durante il salvataggio: "+t.message)):x.push(`/cantieri/${e.id}`)}catch(e){console.error("Error:",e),alert("Errore durante il salvataggio")}finally{v(!1)}},er=async()=>{let{count:t}=await h.from("movements").select("*",{count:"exact",head:!0}).eq("worksite_id",e.id);if(t&&t>0)return void alert(`Non puoi eliminare questo cantiere perch\xe9 ha ${t} movimenti associati. Puoi invece cambiare lo stato a "Completato".`);if(confirm("Sei sicuro di voler eliminare questo cantiere? Questa azione non puÃ² essere annullata.")){N(!0);try{let{error:t}=await h.from("worksites").delete().eq("id",e.id);t?(console.error("Error deleting worksite:",t),alert("Errore durante l'eliminazione: "+t.message)):x.push("/cantieri")}catch(e){console.error("Error:",e),alert("Errore durante l'eliminazione")}finally{N(!1)}}};return p||b?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(c.Loader2,{className:"w-8 h-8 text-violet-600 animate-spin"})}):g?w?(0,t.jsxs)("div",{className:"min-h-screen pb-24",children:[(0,t.jsxs)("header",{className:"bg-gradient-to-r from-violet-500 via-purple-600 to-indigo-600 text-white px-4 pt-12 pb-6 rounded-b-3xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("button",{onClick:()=>x.back(),className:"p-2 -ml-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,t.jsx)(o.ArrowLeft,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"text-purple-100",children:"Modifica Cantiere"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center",children:(0,t.jsx)(n.Building2,{className:"w-7 h-7"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"bg-white/20 px-2 py-0.5 rounded text-xs font-medium",children:z}),(0,t.jsx)("h1",{className:"text-xl font-bold mt-1",children:w.name})]})]})]}),(0,t.jsxs)("form",{onSubmit:ea,className:"px-4 -mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl border border-gray-200 p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Codice (non modificabile)"}),(0,t.jsx)("input",{type:"text",value:z,disabled:!0,className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-500 bg-gray-100 cursor-not-allowed font-mono"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Cantiere *"}),(0,t.jsx)("input",{type:"text",value:C,onChange:e=>A(e.target.value),placeholder:"Es. Uffici Via Roma",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Indirizzo *"}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>_(e.target.value),placeholder:"Es. Via Roma 123",className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-3",children:[(0,t.jsxs)("div",{className:"col-span-2 bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CittÃ  *"}),(0,t.jsx)("input",{type:"text",value:M,onChange:e=>T(e.target.value),placeholder:"Milano",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500",required:!0})]}),(0,t.jsxs)("div",{className:"col-span-2 bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CAP"}),(0,t.jsx)("input",{type:"text",value:L,onChange:e=>R(e.target.value),placeholder:"20100",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{className:"col-span-1 bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prov."}),(0,t.jsx)("input",{type:"text",value:B,onChange:e=>I(e.target.value.toUpperCase()),placeholder:"MI",maxLength:2,className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 uppercase focus:outline-none focus:ring-2 focus:ring-violet-500"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4 space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Dati Cliente"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ragione Sociale"}),(0,t.jsx)("input",{type:"text",value:P,onChange:e=>q(e.target.value),placeholder:"Azienda Srl",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referente"}),(0,t.jsx)("input",{type:"text",value:U,onChange:e=>V(e.target.value),placeholder:"Mario Rossi",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefono"}),(0,t.jsx)("input",{type:"tel",value:O,onChange:e=>D(e.target.value),placeholder:"+39 02 1234567",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",value:F,onChange:e=>H(e.target.value),placeholder:"info@azienda.it",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Codice Fiscale"}),(0,t.jsx)("input",{type:"text",value:Y,onChange:e=>G(e.target.value.toUpperCase()),placeholder:"RSSMRA80A01H501U",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 uppercase font-mono focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Partita IVA"}),(0,t.jsx)("input",{type:"text",value:K,onChange:e=>$(e.target.value),placeholder:"IT01234567890",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 font-mono focus:outline-none focus:ring-2 focus:ring-violet-500"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget Mensile â‚¬"}),(0,t.jsx)("input",{type:"number",value:Q,onChange:e=>J(Number(e.target.value)),min:"0",step:"100",className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stato"}),(0,t.jsx)("select",{value:W,onChange:e=>X(e.target.value),className:"w-full px-3 py-3 rounded-xl border border-gray-200 text-gray-900 focus:outline-none focus:ring-2 focus:ring-violet-500",children:Object.entries(i.STATUS_LABELS).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (opzionale)"}),(0,t.jsx)("textarea",{value:Z,onChange:e=>ee(e.target.value),placeholder:"Note aggiuntive...",rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-200 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-violet-500 resize-none"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{type:"submit",disabled:y||!C.trim()||!E.trim()||!M.trim(),className:"w-full flex items-center justify-center gap-2 p-4 bg-gradient-to-r from-violet-600 to-purple-600 text-white rounded-2xl font-semibold hover:from-violet-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"w-5 h-5 animate-spin"}),"Salvataggio..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Save,{className:"w-5 h-5"}),"Salva Modifiche"]})}),(0,t.jsx)("button",{type:"button",onClick:er,disabled:j,className:"w-full flex items-center justify-center gap-2 p-4 bg-white border-2 border-red-200 text-red-600 rounded-2xl font-semibold hover:bg-red-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"w-5 h-5 animate-spin"}),"Eliminazione..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Trash2,{className:"w-5 h-5"}),"Elimina Cantiere"]})})]})]})]}):null:(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,t.jsx)(u.ShieldAlert,{className:"w-8 h-8 text-red-600"})}),(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Accesso Negato"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"Solo i superuser possono modificare i cantieri."}),(0,t.jsx)("button",{onClick:()=>x.push("/cantieri"),className:"px-4 py-2 bg-violet-600 text-white rounded-xl font-medium",children:"Torna ai Cantieri"})]})}e.s(["default",()=>x])}]);