(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59897,e=>{"use strict";var r=e.i(43476),t=e.i(71645),u=e.i(11795);let n=(0,t.createContext)({user:null,profile:null,loading:!0,isSuperuser:!1,isManager:!1,isManagerOrSuperuser:!1,signOut:async()=>{},refreshProfile:async()=>{}});function l({children:e}){let[l,s]=(0,t.useState)(null),[a,i]=(0,t.useState)(null),[o,c]=(0,t.useState)(!0),h=(0,t.useRef)((0,u.createClient)()).current,f=async e=>{let{data:r,error:t}=await h.from("profiles").select("*").eq("id",e).single();return t?(console.error("Error fetching profile:",t),null):r},d=async()=>{l&&i(await f(l.id))};(0,t.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{session:r},error:t}=await h.auth.getSession();if(!e)return;if(t||!r){s(null),i(null),c(!1);return}s(r.user),f(r.user.id).then(r=>{e&&i(r)}),c(!1)}catch(r){console.error("Auth init error:",r),e&&(s(null),i(null),c(!1))}})();let{data:{subscription:r}}=h.auth.onAuthStateChange(async(r,t)=>{e&&(t?.user?(s(t.user),f(t.user.id).then(r=>{e&&i(r)})):(s(null),i(null)),c(!1))});return()=>{e=!1,r.unsubscribe()}},[]);let g=async()=>{await h.auth.signOut(),s(null),i(null),window.location.href="/login"},p=a?.role==="superuser",y=a?.role==="manager",S=p||y;return(0,r.jsx)(n.Provider,{value:{user:l,profile:a,loading:o,isSuperuser:p,isManager:y,isManagerOrSuperuser:S,signOut:g,refreshProfile:d},children:e})}e.s(["AuthProvider",()=>l,"useAuth",0,()=>(0,t.useContext)(n)])}]);